<!DOCTYPE html>
<html>
<head>
    <title>Speech to Text Conversion and Sentiment Analysis</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='Styles2.css') }}">
   <script>
        // Function to start speech recognition
        function startSpeechRecognition() {
            var recognition = new webkitSpeechRecognition(); // Create a new instance of SpeechRecognition
            recognition.lang = 'en-US'; // Set the language to English (US)

            // Event listener for when speech recognition starts
            recognition.onstart = function() {
                console.log('Speech recognition started');
            };

            // Event listener for when speech is recognized
            recognition.onresult = function(event) {
                var result = event.results[0][0].transcript; // Get the recognized speech
                document.getElementById('text_input').value = result; // Set the value of the textarea to the recognized speech
                recognition.stop(); // Stop speech recognition
            };

            // Event listener for when speech recognition ends
            recognition.onend = function() {
                console.log('Speech recognition ended');
            };

            // Start speech recognition
            recognition.start();
        }

        // Function to redirect after 3 clicks
       // Function to redirect after 3 clicks
function redirectToResult() {
    let clickCount = 0;
    const outputDiv = document.getElementById('output');

    document.getElementById('emergencyButton').addEventListener('click', function() {
        clickCount++;
        outputDiv.innerHTML += `Click detected: ${clickCount}<br>`;

        if (clickCount === 3) {
            window.location.href = "/predict"; // Redirect to the integrated result page
        }
    });
}


        // Call the function when the page loads
        window.onload = redirectToResult;
    </script>
</head>
<body> <h1>Click Thrice, For Physically Challenged</h1>
    <button id="emergencyButton"><h4>EMERGENCY</h4></button>
    <div id="output"></div>
    
    <h1>Speech to Text Conversion</h1>
    <!-- Button to start speech recognition -->
    <button onclick="startSpeechRecognition()">START RECORDING</button>
  
    <div>
        <!-- <h2>Converted Text:</h2> -->
        <p>{{ converted_text }}</p>
    </div>
    
    <h1>Sentiment Analysis</h1>
    <form action="/predict" method="POST">
        <!-- Textarea for user input -->
        <textarea name="text_input" id="text_input" rows="4" cols="50"></textarea><br><br>
        <!-- Submit button -->
        <input type="submit" value="ANALYSE">
    </form>
</body>
</html>
